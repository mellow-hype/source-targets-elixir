
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">

<SCRIPT type="text/javascript">
<!--
function getValLen(val)
{
var len = 0;
var i = 0;
for (i = 0; i < val.length; i ++)
{
var c = val.charAt(i);
len += ((c >= ' ') && (c <= '~')) ? 1 : 2;
}
return len;
}
function doBack()
{
var LP = location.pathname;
location.href = LP + "?Return=Back";
}
function checkTimeFormat(time)
{
if(time.length != 4)
{
return false;
}
var int_time = parseInt(time, 10);
if(int_time/100 < 0 || int_time/100 >= 24)
{
return false;
}
if(int_time%100 < 0 || int_time%100 > 59)
{
return false;
}
return true;
}
function doSubmit()
{
var desc_len = getValLen(document.forms[0].time_sched_name.value);
if ((desc_len < 1) || (desc_len > 24))
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_pl_sch_name);
var element = document.forms[0].time_sched_name;
if(element)
{
element.focus();
element.select();
}
return false;
}
if (document.forms[0].day_type_choose.checked==true)
{
if (
(document.forms[0].Mon_select.checked == 0)&&
(document.forms[0].Tue_select.checked == 0)&&
(document.forms[0].Wed_select.checked == 0)&&
(document.forms[0].Thu_select.checked == 0)&&
(document.forms[0].Fri_select.checked == 0)&&
(document.forms[0].Sat_select.checked == 0)&&
(document.forms[0].Sun_select.checked == 0)
)
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_pl_sel_day);
return false;
}
}
if  (document.forms[0].all_hours.checked == false)
{
if (document.forms[0].time_sched_start_time.value=="")
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_pl_begin_time);
var element = document.forms[0].time_sched_start_time;
if(element)
{
element.focus();
element.select();
}
return false;
}
if (document.forms[0].time_sched_end_time.value=="")
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_pl_end_time);
var element = document.forms[0].time_sched_end_time;
if(element)
{
element.focus();
element.select();
}
return false;
}

var st=parseInt(document.forms[0].time_sched_start_time.value, 10);
var et=parseInt(document.forms[0].time_sched_end_time.value, 10);
if (st > et)
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_end_n_start_time);
var element = document.forms[0].time_sched_end_time;
if(element)
{
element.focus();
element.select();
}
return false;
}
if(!checkTimeFormat(document.forms[0].time_sched_start_time.value))
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_wrong_start_time);
var element = document.forms[0].time_sched_start_time;
if(element)
{
element.focus();
element.select();
}
return false;
}
if(!checkTimeFormat(document.forms[0].time_sched_end_time.value))
{
alert(str_pages.ntw_wzd_acc_ctl_sch.js_wrong_end_time);
var element = document.forms[0].time_sched_end_time;
if(element)
{
element.focus();
element.select();
}
return false;			
}
}

return true;
}
function change_weekdays_status(Status)
{
if (Status == 1)
{
document.forms[0].Mon_select.checked = 1;
document.forms[0].Tue_select.checked = 1;
document.forms[0].Wed_select.checked = 1;
document.forms[0].Thu_select.checked = 1;
document.forms[0].Fri_select.checked = 1;
document.forms[0].Sat_select.checked = 1;
document.forms[0].Sun_select.checked = 1;

document.forms[0].Mon_select.disabled = 1;
document.forms[0].Tue_select.disabled = 1;
document.forms[0].Wed_select.disabled = 1;
document.forms[0].Thu_select.disabled = 1;
document.forms[0].Fri_select.disabled = 1;
document.forms[0].Sat_select.disabled = 1;
document.forms[0].Sun_select.disabled = 1;
}
else if (Status == 0)
{
document.forms[0].Mon_select.checked = wzdSchedInf[2];
document.forms[0].Tue_select.checked = wzdSchedInf[3];
document.forms[0].Wed_select.checked = wzdSchedInf[4];
document.forms[0].Thu_select.checked = wzdSchedInf[5];
document.forms[0].Fri_select.checked = wzdSchedInf[6];
document.forms[0].Sat_select.checked = wzdSchedInf[7];
document.forms[0].Sun_select.checked = wzdSchedInf[8];

document.forms[0].Mon_select.disabled = 0;
document.forms[0].Tue_select.disabled = 0;
document.forms[0].Wed_select.disabled = 0;
document.forms[0].Thu_select.disabled = 0;
document.forms[0].Fri_select.disabled = 0;
document.forms[0].Sat_select.disabled = 0;
document.forms[0].Sun_select.disabled = 0;
}
}
function change_hours_status()
{
if (document.forms[0].all_hours.checked == 1)
{
document.forms[0].time_sched_start_time.disabled = 1;
document.forms[0].time_sched_end_time.disabled = 1;
}
else
{
document.forms[0].time_sched_start_time.disabled = 0;
document.forms[0].time_sched_end_time.disabled = 0;
}
}
function check_all_status()
{
document.forms[0].time_sched_name.value = wzdSchedInf[0];
if(1 == wzdSchedInf[1])
{
document.forms[0].day_type_all.checked = true;
}
if (0 == wzdSchedInf[1])
{
document.forms[0].day_type_choose.checked = true;
}
if (document.forms[0].day_type_all.checked == true)
{
change_weekdays_status(1);
}
else
{
change_weekdays_status(0);
}
}
function doHelp(){location.href="../help/LanArpBindingHelpRpm.htm";}
//-->
</SCRIPT>
</HEAD>

<BODY onLoad="setTagStr(document,'ntw_wzd_acc_ctl_sch');LoadHelp('WzdAccessCtrlSchedAddHelpRpm.htm');check_all_status();resize(this);" onResize="resize(this);">
<FORM action="WzdAccessCtrlSchedAddRpm.htm" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
<TABLE id="autoWidth"  name="autoWidth">
<TBODY>

<TR>
<TD class=h1 id = "t_title" name="t_title">Quick Setup - Create an Advanced Schedule Entry</TD>
</TR>
<TR>
<TD class=blue></TD>
</TR>

<TR>
<TD><TABLE width="420" border="0" align="center" cellpadding="3" cellspacing="0" class="space">
<TR>
<TD id="t_note_sch" style="color:#C11C66" colspan=2 name="t_note_sch">Note: The Schedule is based on the time of the Router. </TD>
</TR>
<TR><TD colspan=2>&nbsp;</TD></TR>
<TR>
<TD class="item" width="70" id="t_sch">Schedule Description:</TD>
<TD width="340"><INPUT name="time_sched_name" type="text" class="text" value="" size="25" maxlength="24"></TD>
</TR>
<TR>
<TD class="item" id="t_day" name="t_day">Day:</TD>
<TD><INPUT name="day_type" id="day_type_all" type="radio" value="1" onClick="change_weekdays_status(1)" >
<SPAN id="t_everyday" name="t_everyday">Everyday&nbsp;&nbsp;</SPAN>
<INPUT name="day_type" id="day_type_choose" type="radio" value="0" onClick="change_weekdays_status(0)" >
<SPAN id="t_sel_day" name="t_sel_day">Select Days</SPAN></TD>
</TR>
<TR>
<TD>&nbsp;</TD>
<TD><INPUT type="checkbox" name="Mon_select"  id="Mon_select">
<SPAN id="t_mon" name="t_mon">Mon</SPAN>&nbsp;
<INPUT type="checkbox" name="Tue_select"  id="Tue_select">
<SPAN id="t_tue" name="t_tue">Tue</SPAN>&nbsp;
<INPUT type="checkbox" name="Wed_select"  id="Wed_select">
<SPAN id="t_wen" name="t_wen">Wed</SPAN>&nbsp;
<INPUT type="checkbox" name="Thu_select"  id="Thu_select">
<SPAN id="t_thu" name="t_thu">Thu</SPAN>&nbsp;
<INPUT type="checkbox" name="Fri_select"  id="Fri_select">
<SPAN id="t_fri" name="t_fri">Fri</SPAN>&nbsp;
<INPUT type="checkbox" name="Sat_select"  id="Sat_select">
<SPAN id="t_sat" name="t_sat">Sat</SPAN>&nbsp;
<INPUT type="checkbox" name="Sun_select"  id="Sun_select">
<SPAN id="t_sun" name="t_sun">Sun</SPAN></TD>
</TR>
<TR>
<TD class="item" id="t_time" name="t_time">Time: </TD>
<TD><SPAN id="t_all">all day-24 hours:</SPAN>
<INPUT type="checkbox" name="all_hours" onClick="change_hours_status()" id="all_hours"></TD>
</TR>
<TR>
<TD class="item" id="t_start_time" name="t_start_time">Start Time:</TD>
<TD><INPUT name="time_sched_start_time" type="text" class="text" value="" size="5" maxlength="4" id="time_sched_start_time">
&nbsp;(HHMM)</TD>
</TR>
<TR>
<TD class="item" id="t_stop_time" name="t_stop_time">Stop Time:</TD>
<TD><INPUT name="time_sched_end_time" type="text" class="text" value="" size="5" maxlength="4" id="time_sched_end_time">
&nbsp;(HHMM)</TD>
</TR>
</TABLE></TD>
</TR>
<TR>
<TD class=blue></TD>
</TR>
<TR>
<TD class=mbtn colspan=2>
<INPUT name="Return" class=buttonBig id=PrevStep type=button value="Back" onClick="return doBack();">&nbsp;&nbsp;
<INPUT name="Next" class=buttonBig id=Submit onClick="return doSubmit();" type=submit value=Next>
<INPUT type=hidden name=ClientId id="ClientId">
</TD>
</TR>
</TBODY>
</TABLE>
</FORM>

<SCRIPT type="text/javascript">
document.forms[0].time_sched_name.value =wzdSchedInf[0];
if (document.forms[0].time_sched_name.value == "")
{
wzdSchedInf[1] = 1;
wzdSchedInf[9] = 1;	
}
if(1 == wzdSchedInf[1])
{
document.forms[0].day_type_all.checked = true;
}
if (0 == wzdSchedInf[1])
{
document.forms[0].day_type_choose.checked = true;
}
if (wzdSchedInf[1] == 1)
{
change_weekdays_status(1);
}
else
{
change_weekdays_status(0);
}
document.forms[0].all_hours.checked = wzdSchedInf[9];
change_hours_status();
document.forms[0].time_sched_start_time.value =wzdSchedInf[10];
document.forms[0].time_sched_end_time.value =wzdSchedInf[11];
document.forms[0].ClientId.value=wzdSchedInf[12];
</SCRIPT>
</BODY>
<HEAD>
<META http-equiv="pragma" content="no-cache">
</HEAD>
</HTML>
