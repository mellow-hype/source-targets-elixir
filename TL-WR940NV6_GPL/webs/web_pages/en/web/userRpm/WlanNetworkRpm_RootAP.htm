
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<HTML>
<HEAD><TITLE>TL-WR945N</TITLE>
<META http-equiv=Pragma content=no-cache>
<META http-equiv=Expires content="wed, 26 Feb 1997 08:21:57 GMT">
<LINK href="../dynaform/css_main.css" rel=stylesheet type="text/css">
<SCRIPT language="javascript" src="../dynaform/common.js" type="text/javascript"></SCRIPT>
<SCRIPT language="javascript" type="text/javascript"><!--
if(window.parent == window){//window.location.href="http://";
}
function Click(){ return false;}
document.oncontextmenu=Click;
//--></SCRIPT>
<SCRIPT language=javascript src="../localiztion/str_err.js" type="text/javascript"></SCRIPT>
<SCRIPT language="JavaScript" src="../dynaform/custom.js" type="text/JavaScript"></SCRIPT>
<SCRIPT language="JavaScript" src="../dynaform/common.js" type="text/JavaScript"></SCRIPT>
<SCRIPT language=javascript src="../localiztion/char_set.js" type="text/javascript"></SCRIPT>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<SCRIPT type="text/javascript"><!-- 

//{
//	location.href="../help/WlanNetworkHelpRpm_rootap.htm";
//}
function getValLen(val)
{
var len = 0;
var i = 0;
for (i = 0; i < val.length; i ++)
{
var c = val.charAt(i);
len += ((c >= ' ') && (c <= '~')) ? 1 : 2;
}
return len;
}

function checkname(szname)
{
var c;
var ch = "0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$%^&*()-=_+[]{};:\'\"\\|/?.,<>/ ";

for (var i = 0; i < szname.length; i++)
{
c = szname.charAt(i);
if (ch.indexOf(c) == -1)
return false;
}
return true;
}

function doSelKeytype()
{
var cf = document.forms[0];
if (cf.keytype.value == 2) // wep
{
document.getElementById("t_wep_index").style.display = "";
document.getElementById("t_key_format").style.display = "";
document.getElementById("t_key_text").style.display = "";
document.getElementById("t_password").style.display = "none";
cf.keytext.maxLength = (cf.keyformat.value == 2)? 16:32;
document.getElementById("t_wds_sec_note").style.display = "";
}
else if(cf.keytype.value == 4) //wpa/wpa2-psk
{
document.getElementById("t_wep_index").style.display = "none";
document.getElementById("t_key_format").style.display = "none";
document.getElementById("t_key_text").style.display = "none";
document.getElementById("t_password").style.display = "";
cf.password.maxLength = 64;
document.getElementById("t_wds_sec_note").style.display = "none";
}
else if(cf.keytype.value == 1) // no security
{
document.getElementById("t_wep_index").style.display = "none";
document.getElementById("t_key_format").style.display = "none";
document.getElementById("t_key_text").style.display = "none";
document.getElementById("t_password").style.display = "none";
document.getElementById("t_wds_sec_note").style.display = "none";
}
return true;
}

function Dialog(url, action, init)
{
return Dialog._geckoOpenModal(url,action,init);
}
Dialog._return = null;
Dialog._modal = null;
Dialog._arguments = null;
Dialog._parentEvent = function(ev)
{
if (Dialog._modal && !Dialog._modal.closed){Dialog._modal.focus();}
};
Dialog._geckoOpenModal = function(url,action,init)
{
var dlg = window.open(url,"ha_dialog","width=700,height=500,scrollbars=yes,resizable=yes,toolbar=no,menubar=no,personalbar=no");
Dialog._modal = dlg;
Dialog._arguments = init;
capwin(window.parent);
for (var i=0; i<window.parent.frames.length;capwin(window.parent.frames[i++]))
;
Dialog._return = function(val){
if (val && action)
action(val);
relwin(window.parent);
for (var i=0; i<window.parent.frames.length; relwin(window.parent.frames[i++]))
;
Dialog._modal = null;
}
}
function capwin(w)
{
if (document.all){
w.attachEvent("onclick",Dialog._parentEvent);
w.attachEvent("onmousedown",Dialog._parentEvent);
w.attachEvent("onfocus",Dialog._parentEvent);
}
else{
w.addEventListener("click",Dialog._parentEvent,true);
w.addEventListener("mousedown",Dialog._parentEvent,true);
w.addEventListener("focus",Dialog._parentEvent,true);
}}
function relwin(w)
{
if (document.all){
w.detachEvent("onfocus",Dialog._parentEvent);
w.detachEvent("onmousedown",Dialog._parentEvent);
w.detachEvent("onclick",Dialog._parentEvent);
}
else{
w.delEventListener("focus",Dialog._parentEvent,true);
w.delEventListener("mousedown",Dialog._parentEvent,true);
w.delEventListener("click",Dialog._parentEvent,true);
}}
function generateURL()
{
var url = "../userRpm/popupSiteSurveyRpm_AP.htm";
url += "?iMAC=rptBssid&iSSID=rptSsid";
return url;
}
function doSurvey()
{
Dialog (generateURL(), "", "");
}

function checkwephexkey(szkey)
{
var c;
var ch = "0123456789ABCDEFabcdef";

for (var i = 0; i < szkey.length; i++)
{
c = szkey.charAt(i);
if (ch.indexOf(c) == -1)
return false;
}
return true;
}

function checkwepasiikey(szkey)
{
var c;
var ch = "0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$^&*()-=_+[]{};:\'\"\\|/?.,<>/% ";

for (var i = 0; i < szkey.length; i++)
{
c = szkey.charAt(i);
if (ch.indexOf(c) == -1)
return false;
}
return true;
}

function checkAuth()
{
var cf = document.forms[0];
var len;
var sectype = 0;

if (cf.keytype.value == 2) // wep
{
len = getValLen(cf.keytext.value);
if(cf.keyformat.value == 2)	//asii
{
if( len != 5 && len != 13 && len != 16  )
{//="The ASCII key'length must be 5,13 or 16!"
alert(str_pages.ntw_wlan_network_rootap.js_key_corret1);
cf.keytext.focus();		
return false;
}
if (checkwepasiikey(cf.keytext.value) == false)
{//="The ASCII wep key includes illegal characters!"
alert(str_pages.ntw_wlan_network_rootap.js_wepkey_corret1);
cf.keytext.focus();	
return false;
}	
}
else if(cf.keyformat.value == 3)	//hex
{
if( len != 10 && len != 26 && len != 32  )
{//="The Hexadecimal key'length must be 10,26 or 32!"
alert(str_pages.ntw_wlan_network_rootap.js_key_corret2);
cf.keytext.focus();		
return false;
}
if (checkwephexkey(cf.keytext.value) == false)
{//="The Hexadecimal key includes illegal characters!"
alert(str_pages.ntw_wlan_network_rootap.js_wepkey_corret2);
cf.keytext.focus();	
return false;
}	
}		
}
else if (cf.keytype.value == 4) // wpa-psk
{
len = getValLen(cf.password.value);
if (len <= 0)
{//="Empty Wireless password, please input one!"
alert(str_pages.ntw_wlan_network_rootap.js_empty_psk_password);
cf.password.focus();
return false;
}
if ((len > 0) && (len < 8))
{//="Wireless password should not be less than 8 characters, please input again!"
alert(str_pages.ntw_wlan_network_rootap.js_psk_char);
cf.password.focus();
cf.password.select();
return false;
}
else if(len < 64)
{
var ch = "0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$^&*()-=_+[]{};:\'\"\\|/?.,<>/% ";
var c;
for(i = 0; i < len; i++)
{
c = cf.password.value.charAt(i);
if(ch.indexOf(c) == -1)
{//="The Wireless password include illegal characters, please input again."
alert(str_pages.ntw_wlan_network_rootap.js_psk_hex1);
cf.password.focus();
cf.password.select();
return false;
}
}
}
else 
{
var ch = "0123456789ABCDEFabcdef";
var c;
for(i = 0; i < len; i++)
{
c = cf.password.value.charAt(i);
if(ch.indexOf(c) == -1)
{//="The 64 bytes Wireless password include non-hexadecimal characters, please input again."
alert(str_pages.ntw_wlan_network_rootap.js_psk_hex2);
cf.password.focus();
cf.password.select();
return false;
}
}
}		
}
else if (cf.keytype.value == 1) // no security
{
return true;
}
return true;
}

function doSubmit()
{
var cf = document.forms[0];
if (!checkAuth())
return false;

if(getValLen(cf.rptSsid.value)==0)
{//="Please input SSID!"
alert(str_pages.ntw_wlan_network_rootap.js_pl_ssid);
cf.rptSsid.focus();
cf.rptSsid.select();
return false;
}
else if(getValLen(cf.rptSsid.value)>32)
{//="The SSID cannot exceed 32 characters. Please input correctly!"
alert(str_pages.ntw_wlan_network_rootap.js_ssid_exe);
cf.rptSsid.focus();
cf.rptSsid.select();
return false;
}

if (!checkname(document.forms[0].rptSsid.value))
{//="The remote AP SSID contains illegal characters, please input another one!"
alert(str_pages.ntw_wlan_network_rootap.js_ssid_ill);
cf.rptSsid.focus();
cf.rptSsid.select();
return false;
}
if(!is_macaddr(cf.rptBssid.value))
{
cf.rptBssid.focus();
cf.rptBssid.select();
return false;
}

cf.ap.value=1;  // enable wireless

return true;
}


//--></SCRIPT>
</HEAD>
<BODY  onload="setTagStr(document,'ntw_wlan_network_rootap');LoadHelp('WlanNetworkHelpRpm_rootap.htm'); resize(this);" >
<CENTER>
<FORM onSubmit="return doSubmit();" action="WlanNetworkRpm_RootAP.htm" method="get" enctype="multipart/form-data">
<TABLE id="autoWidth" border = 0>
<TBODY>
<TR>
<TD class="h1" colspan=2 id="t_title">Connect to Host Network</TD>
</TR>
<TR>
<TD class="blue" colspan=2></TD>
</TR>

<TR id="t_wireless_radio" style="display:none;">
<TD>&nbsp;</TD>
<TD id="wireless_radio"><INPUT type="checkbox" value=1 name="ap"><A id="t_enwi">Enable Wireless Radio</A></TD>
</TR>

<TR id="t_wireless_channel" style="display:none;">
<TD class=item style="padding-left:60px" id="t_ochannelname">Channel:</TD>
<TD><SELECT style = "width:110px" name="channel">
<option value=1 >1</option>
<option value=2 >2</option>
<option value=3 >3</option>
<option value=4 >4</option>
<option value=5 >5</option>
<option value=6 >6</option>
<option value=7 >7</option>
<option value=8 >8</option>
<option value=9 >9</option>
<option value=10>10</option>
<option value=11>11</option>
<option value=12>12</option>
<option value=13>13</option>
<option value=14>14</option>
<option value=15>auto</option>
</SELECT>
</TD>
</TR>

<TR>
<td class=item style="padding-left:60px" id="t_ssid_to">SSID(to be bridged):</TD>
<TD><input name="rptSsid" type="text" class="text" id="rptSsid" value="" size="32" maxlength="32"></TD>
</TR>

<TR>
<td class=item style="padding-left:60px"><span id="t_macOfAP1">MAC Address(to be bridged):</span></td>
<TD><input id="rptBssid" name="rptBssid" type="text" class="text" value="" size="17" maxlength="17"></TD>
</TR>

<TR id="line_survey">
<TD>&nbsp;</TD>
<TD align="left">
<INPUT name="survey" id="survey" type="button" class="button" value="Survey" onClick="doSurvey();" />
</TD>
</TR>

<TR id="t_auth_type"> 
<TD class=item style="padding-left:60px" id="t_security">Security:</TD>
<TD>
<SELECT style="width:210px" name="keytype" onChange="doSelKeytype()">
<option value=1 id="t_none">No Security</option>
<option value=2 id="t_wep">WEP</option>
<option value=4 id="t_wpa">WPA/WPA2-PSK</option>							
</SELECT>
</TD>
</TR>

<TR id="t_wep_index">
<TD class="Item" id="t_wepindex" style="padding-left:30px">WEP Index:</TD>
<TD>
<SELECT name="wepindex" style = "width:210px">
<OPTION value=1>1</OPTION>
<OPTION value=2>2</OPTION>
<OPTION value=3>3</OPTION>
<OPTION value=4>4</OPTION>
</SELECT>
</TD>
</TR>

<TR id="t_key_format">
<TD class="Item" id="t_keyformat" style="padding-left:30px">Key Format:</TD>
<TD>
<SELECT id="keyformat" name="keyformat" style = "width:210px" onChange="doSelKeytype();">
<OPTION value="2" id="t_ascii" selected="selected">ASCII</OPTION>
<OPTION value="3" id="t_hex">Hexadecimal</OPTION>
</SELECT>
</TD>
</TR>

<TR id="t_key_text">
<TD class=Item style="padding-left:30px" id="t_keytext">Password:</TD>
<TD><INPUT name="keytext" type=text class=text id="keytext" size="32"></TD>
</TR>				

<TR id="t_password">
<TD class=Item style="padding-left:30px" id="t_passwd">Password:</TD>
<TD>
<INPUT name="password" type=text class=text id="password" />
</TD>
</TR>

<TR id="t_wds_sec_note">
<TD class="Item" style="padding-left:30px" disabled></TD>
<TD>
<span id="t_wds_sec_note1">The Security Mode of Remote AP is WEP. Please selected Key Format and WEP index.</span>
</TD>
</TR>

<TR id="t_wds_mode">
<TD class="Item" style="padding-left:30px" id="t_addrType">WDS Mode:</TD>
<TD>
<SELECT name="addrType" class="listS">
<OPTION value=1 id="t_auto" name="t_auto">Auto</OPTION>
<OPTION value=2 name="t_three">WDS1</OPTION>
<OPTION value=3 name="t_four">WDS2</OPTION>
</SELECT>
</TD>
</TR>

<TR>
<TD class="blue" colspan=2></TD>
</TR>
<TR>
<TD></TD>
<TD><INPUT class="buttonBig" id="Save" type="submit" value="Save" name="Save"></TD>
</TR>
</TBODY>
</TABLE>
</FORM>
</CENTER>

</BODY>
</HTML>
<SCRIPT type="text/javascript">
var df = document.forms[0];
df.rptSsid.value=wlanReRootapPara[0];
df.rptBssid.value=wlanReRootapPara[1];
df.ap.checked = true;
if(wlanReRootapPara[2]==0) // No security
{
df.keytype.value=1;
}
else 
{
if (wlanReRootapPara[3] == 1)  // WEP
{
df.keytype.value = 2;
}
else  					// WPA/WPA2-PSK
{
df.keytype.value = 4;
}
}
document.forms[0].addrType.value = wlanReRootapPara[9];
df.wepindex.value = wlanReRootapPara[5];	//wepindex 1 2 3 4

df.keyformat.value = ((wlanReRootapPara[6] == 2) ? 2 :3);  //1 HEX 2 ASCII

df.keytext.value = wlanReRootapPara[8];
df.password.value = wlanReRootapPara[4];
//
// display setting
//
doSelKeytype();		
</SCRIPT>
